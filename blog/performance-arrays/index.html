<!DOCTYPE html><html  lang="pt-BR"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Listas performáticas usando canos e transdutores</title>
<style>@import"https://carlinhos.dev.br/shared/styles/theme.css";:root{--color__900:var(--bg_s);--color__800:var(--bg1);--color__700:var(--bg2);--color__600:var(--bg3);--color__500:var(--bg4);--color__400:var(--gray_dim);--color__300:var(--fg4);--color__200:var(--fg3);--color__100:var(--fg2);--border__regular:.25rem solid var(--color__primary);--border__big:.5rem solid var(--color__primary)}*{background-color:transparent;box-sizing:border-box;color:var(--color__text);font-weight:300;margin:0;padding:0;text-decoration:none}::-moz-selection{background-color:var(--color__primary);color:var(--color__text)}::selection{background-color:var(--color__primary);color:var(--color__text)}body,div#__nuxt,html{align-items:center;box-sizing:border-box;display:flex;flex-direction:column;justify-content:center;margin:0 auto;min-height:100%}html{background-color:var(--color__background)}h1{border-left:var(--border__big);font-size:var(--font-size__4);padding-left:.5rem}h1,h2{font-family:var(--font__heading);font-weight:600}h2{font-size:var(--font-size__3);-webkit-text-decoration:underline var(--color__primary) 5px;text-decoration:underline var(--color__primary) 5px}h3{font-family:var(--font__heading);font-size:var(--font-size__2);font-weight:600}h3:before{color:var(--color__primary);content:"> ";font-weight:700}h4{border-left:var(--border__regular);font-family:var(--font__heading);font-size:var(--font-size__3);font-weight:600;padding-left:.5rem}p{font-family:var(--font__body);font-size:var(--font-size__1);-webkit-hyphens:auto;hyphens:auto;line-height:var(--line-height__body);text-align:justify}abbr{font-weight:inherit;-webkit-text-decoration:dotted underline 1px;text-decoration:dotted underline 1px}strong{font-weight:700}em,strong{color:inherit}em{font-weight:inherit}:not(h1,h2,h3,h4,nav)>a{color:var(--color__primary);font-weight:700}:not(h1,h2,h3,h4,nav)>a:hover{text-decoration:underline}pre{border:1px solid var(--color__500);border-radius:.5rem;margin:0 auto;max-width:40rem;padding:1rem}pre span{font-family:var(--font__monospace);letter-spacing:-.05rem}ol,ul{list-style-position:inside}ul li::marker{color:var(--color__accent);content:"> ";font-weight:700}li{font-family:var(--font__body);font-size:var(--font-size__1);-webkit-hyphens:auto;hyphens:auto}li::marker{color:var(--color__accent);font-family:var(--font__monospace),monospace;font-weight:700}li>a{color:var(--color__secondary)}li>a:hover{color:var(--color__accent)}:is(article,section)>ol,:is(article,section)>ul{margin-top:var(--size__1)}:is(article,section)>ol ol,:is(article,section)>ol ul,:is(article,section)>ul ol,:is(article,section)>ul ul{padding-left:var(--size__1)}:is(article,section)>ol ol ol,:is(article,section)>ol ol ul,:is(article,section)>ol ul ol,:is(article,section)>ol ul ul,:is(article,section)>ul ol ol,:is(article,section)>ul ol ul,:is(article,section)>ul ul ol,:is(article,section)>ul ul ul{padding-left:calc(var(--size__1)*2)}blockquote{background-color:var(--color__background);border-radius:.5rem;margin:2rem auto;padding:1rem;width:70%}blockquote p{font-family:var(--font__body);font-size:var(--font-size__1);font-style:italic;font-weight:400;-webkit-hyphens:auto;hyphens:auto;line-height:var(--line-height__body);margin:0;text-align:center}blockquote:after,blockquote:before{background-color:transparent;color:var(--color__800);display:block;font-size:var(--font-size__2);height:1rem;line-height:0;position:relative}blockquote:before{content:"“";float:left;transform:translate(-.7rem,.5rem)}blockquote:after{content:"”";float:right;transform:translate(.5rem,.7rem)}header a{color:var(--color__500);font-family:var(--font__heading);font-size:var(--font-size__1);font-weight:700;text-decoration:none;transition-duration:.2s}header a:before{color:var(--color__500);content:">";font-weight:700;margin-right:var(--size__05);transition-duration:.2s}header a:hover{color:var(--color__text);text-decoration:none}header a:hover:before{color:var(--color__primary);margin-right:var(--size__1)}</style>
<style>html{scroll-padding-top:2rem}#post{align-items:center;display:flex;flex-direction:column;max-width:50rem}#post header{display:flex;flex-direction:column;gap:var(--size__1);margin-top:var(--size__4)}#post header h1{border-left:var(--border__big);font-family:var(--font__heading);font-size:var(--font-size__4);padding-left:var(--size__1)}#post header a{color:var(--color__500);font-family:var(--font__heading);font-size:var(--size__big);font-weight:700;transition-duration:.2s}#post header a:before{color:var(--color__500);content:"> ";font-weight:700}#post header a:hover{color:var(--color__text)}#post header a:hover:before{color:var(--color__primary)}#post main>article{display:flex;flex-direction:column;margin-bottom:var(--size__4)}#post main>article>p{font-family:var(--font__body);-webkit-hyphens:auto;hyphens:auto;margin-top:var(--size__1);text-align:justify}#post main>article>p>a{color:var(--orange)}#post main>article>p>a:hover{color:var(--yellow)}#post main>article>p>strong{font-weight:700}#post main>article>p>em{font-weight:inherit}#post main>article>p>sup{cursor:pointer}#post main>article>p>sup>span{color:var(--orange)}#post main>article h2{padding-top:var(--size__3);text-decoration:underline;text-decoration-color:var(--color__primary);text-decoration-thickness:5px}#post main>article h2 a{font-family:var(--font__heading);font-size:var(--font-size__3);font-weight:600}#post main>article h3{padding-top:var(--size__2)}#post main>article h3 a{font-family:var(--font__heading);font-size:var(--font-size__2);font-weight:600}#post main>article h3 a:before{color:var(--color__primary);content:"> ";font-weight:700}#post main>article h4{border-left:5px solid var(--color__primary);margin-top:var(--size__2);padding-left:.5rem}#post main>article h4 a{font-family:var(--font__heading);font-size:var(--font-size__2);font-weight:600}#post main>article pre{border:1px solid var(--color__500);border-radius:.5rem;margin:0 auto;margin-top:var(--size__1);max-width:40rem;padding:1rem}#post main>article pre span{font-family:var(--font__monospace);letter-spacing:-.05rem}#post main>article ol,#post main>article ul{display:flex;flex-direction:column;gap:var(--size__05)}#post main>article li{font-size:var(--size__base);font-weight:lighter;-webkit-hyphens:auto;hyphens:auto;line-height:var(--line-height)}#post main>article li :is(ol,ul){margin-top:var(--size__05)}#post main>article li :is(ol,ul) :is(ol,ul){margin-top:var(--size__05)}#post main>article li::marker{color:var(--yellow);font-family:var(--font__monospace);font-weight:700}#post main>article blockquote{background-color:var(--bg);border-radius:.5rem;margin:0 auto;margin-top:var(--size__1);padding:1rem;width:70%}#post main>article blockquote p{font-family:var(--font__body);font-size:var(--size__base);font-style:italic;font-weight:400;-webkit-hyphens:auto;hyphens:auto;line-height:var(--line-height);margin:0;text-align:center}#post main>article blockquote:after,#post main>article blockquote:before{background-color:transparent;color:var(--bg2);display:block;font-size:3rem;height:1rem;line-height:0;position:relative}#post main>article blockquote:before{content:"“";float:left;transform:translate(-.7rem,.5rem)}#post main>article blockquote:after{content:"”";float:right;transform:translate(.4rem,.7rem)}#post hr{color:var(--color__background);margin:4rem;width:100%}#post section.footnotes{display:none}@media (max-width:640px){#post{margin:0 var(--size__2)}#post header{align-items:center;margin-top:var(--size__3)}#post header h1{border-bottom:var(--border__big);border-bottom-style:double;border-left:none;border-top:var(--border__big);border-top-style:double;font-size:var(--font-size__3);margin-bottom:var(--size__1);margin-top:var(--size__1);padding-left:0;text-align:center}#post main>article{border-radius:0}#post main>article pre{font-size:var(--size__small)}#post main>article blockquote{width:100%}#post main>article blockquote:after,#post main>article blockquote:before{display:none}}</style>
<style>pre code .line{display:block}</style>
<style>dialog[data-v-8e2d3e8b]{background-color:var(--color__background);border-radius:.5rem;cursor:default;padding:.25rem .5rem}</style>
<link rel="preload" as="fetch" crossorigin="anonymous" href="/blog/performance-arrays/_payload.json?f8327c24-0f4e-45b2-b0ba-77ba32894543">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C-0yA-2c.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C95q43FC.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/or1xPPuv.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/RASWqDV0.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CqQyTZ8R.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C0WzvehL.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CsrinIrN.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/mpR218-Y.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BJ__PBhZ.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CGm4g7mo.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/H3mj6LzP.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/5dTGDx6V.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CESTlynp.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CmHFE99l.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CSOacjKa.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DwJMaPAN.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CesHxJxi.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Y8_idytS.js">
<link rel="preload" as="fetch" fetchpriority="low" crossorigin="anonymous" href="/_nuxt/builds/meta/f8327c24-0f4e-45b2-b0ba-77ba32894543.json">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/DJHhecE-.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/DPkpSn1f.js">
<link rel="icon" type="image/png" href="https://emoji.gg/assets/emoji/thonk.png">
<link rel="me" href="https://mastodon.social/@peruibeloko">
<meta name="author" content="Carlinhos">
<script type="module" src="/_nuxt/C-0yA-2c.js" crossorigin></script></head><body><div id="__nuxt"><div id="post"><header><a href="/blog" class="">Voltar</a><h1>Listas performáticas usando canos e transdutores</h1></header><main><article><p><!--[-->Não se assuste com o título, ainda não enlouqueci. Depois de matutar bastante sobre o assunto, achei que valeria a pena tornar público minhas &quot;descobertas&quot; sobre a performance de diferentes maneiras de manipular listas no JavaScript.<!--]--></p><p><!--[-->Enquanto escrevia o post me dei conta de alguns buracos na minha metodologia, o que me levou a revisar várias coisas, incluindo (obviamente) os resultados. Se alguma coisa estiver errada, sinta-se a vontade para abrir uma issue no GitHub.<!--]--></p><h2 id="o-cenário"><!--[-->O cenário<!--]--></h2><p><!--[-->Começamos nossa jornada com um fato muito útil sobre vários métodos do protótipo Array do JavaScript: Eles retornam um novo array, o que nos permite encadear operações<!--]--></p><pre class="language-js shiki shiki-themes gruvbox-dark-hard" style=""><!--[--><code><span class="line" line="1"><span class="sG605">const</span><span class="sMWUE"> arr</span><span class="sM2RB"> =</span><span class="sM0OT"> [</span><span class="ssIPD">1</span><span class="svnLg">,</span><span class="ssIPD">2</span><span class="svnLg">,</span><span class="ssIPD">3</span><span class="sM0OT">]</span><span class="svnLg">;
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span class="sG605">const</span><span class="sMWUE"> result</span><span class="sM2RB"> =</span><span class="sMWUE"> arr
</span></span><span class="line" line="4"><span class="svnLg">  .</span><span class="s59W0">map</span><span class="sM0OT">(</span><span class="sMWUE">x</span><span class="sG605"> =&gt;</span><span class="sMWUE"> x</span><span class="sM2RB"> *</span><span class="ssIPD"> 3</span><span class="sM0OT">) </span><span class="s-UKz">// [3, 6, 9]
</span></span><span class="line" line="5"><span class="svnLg">  .</span><span class="s59W0">filter</span><span class="sM0OT">(</span><span class="sMWUE">x</span><span class="sG605"> =&gt;</span><span class="sMWUE"> x</span><span class="sM2RB"> %</span><span class="ssIPD"> 2</span><span class="sM2RB"> !==</span><span class="ssIPD"> 0</span><span class="sM0OT">) </span><span class="s-UKz">// [3, 9]
</span></span><span class="line" line="6"><span class="svnLg">  .</span><span class="s59W0">reduce</span><span class="sM0OT">(</span><span class="svnLg">(</span><span class="sMWUE">acc</span><span class="svnLg">,</span><span class="sMWUE"> cur</span><span class="svnLg">)</span><span class="sG605"> =&gt;</span><span class="sMWUE"> acc</span><span class="sM2RB"> +</span><span class="sMWUE"> cur</span><span class="sM0OT">)</span><span class="svnLg">;</span><span class="s-UKz"> // 12
</span></span></code><!--]--></pre><p><!--[-->Por que eu considero isso útil? Porque é uma construção que eu uso muito frequentemente.<!--]--></p><p><!--[-->Quando me deparo com um problema normalmente penso primeiro sobre quais informações são relevantes para sua solução, e depois sobre qual sua melhor disposição, e isso costuma envolver Estruturas de Dados, Algoritmos e Tipagem<sup><span aria-describedby="footnote-label" data-footnote-ref id="user-content-fnref-typescript" data-v-8e2d3e8b><dialog style="position:fixed;left:0;top:0;" data-v-8e2d3e8b></dialog><!--[-->1<!--]--></span></sup>.<!--]--></p><p><!--[-->Mas esse não é o motivo desse post, o que vou abordar hoje é a <strong><!--[-->performance<!--]--></strong> dessas operações encadeadas. Importante lembrar que, por bem ou por mal, a maior parte do que eu faço hoje em dia está inserido na web e não necessariamente na parte que lida com quantidades massivas de dados. Isso torna a performance dessas operações não tão relevante, mas não totalmente obsoleta. Estamos falando de no máximo centenas de itens em uma lista no pior dos casos, não alguns milhões!<!--]--></p><p><!--[-->Então a menos que você esteja fazendo algo de uma forma muito “inocente”, ou lidando com quantidades absurdas de informações direto no frontend, performance não deve ser um problema. Mas como todo bom programador hobbista, meu trabalho é resolver problemas que eu mesmo crio!<!--]--></p><h2 id="não-tem-almoço-de-graça-o-custo-da-pureza"><!--[-->Não tem almoço de graça: O custo da pureza<!--]--></h2><p><!--[-->Não é segredo que funções puras são mais fáceis de depurar e racionalizar em uma sequencia complexa de operações do que sua contraparte impura<sup><span aria-describedby="footnote-label" data-footnote-ref id="user-content-fnref-2" data-v-8e2d3e8b><dialog style="position:fixed;left:0;top:0;" data-v-8e2d3e8b></dialog><!--[-->2<!--]--></span></sup>, mas isso normalmente vem com um custo atrelado. No caso dessas operações encadeadas, cada novo método na cadeia <strong><!--[-->aumenta linearmente o tempo de processamento<!--]--></strong>, já que cada método precisa passar por todos os <code><!--[-->n<!--]--></code> elementos da lista.<!--]--></p><p><!--[-->Claro que esse número pode mudar dependendo de filtros ou reduções aplicadas ao longo do processamento, mas estamos falando dos piores casos aqui (<em><!--[-->Big-O<!--]--></em>, por assim dizer). Importante notar que parece intuitivo assumir que o uso de memória também aumenta linearmente — cada método cria uma nova cópia do array — !verificar isso em novo teste!<!--]--></p><p><!--[-->Será então que está tudo perdido para os cientistas de dados que não se renderam ao Pandas?<!--]--></p><h2 id="um-gole-da-poção-um-novo-encanador"><!--[-->Um gole da poção, um novo encanador<!--]--></h2><p><!--[-->Acredito que se tornar programador no Brasil e não ouvir falar do Elixir ou Lua ao menos uma vez em sua carreira seja praticamente impossível. E eu, como todo bom programador brasileiro, não fui diferente.<!--]--></p><p><!--[-->Eu já havia ouvido falar de Pipes em outros contextos, mas foi só quando eu parei durante algumas semanas<sup><span aria-describedby="footnote-label" data-footnote-ref id="user-content-fnref-3" data-v-8e2d3e8b><dialog style="position:fixed;left:0;top:0;" data-v-8e2d3e8b></dialog><!--[-->3<!--]--></span></sup> para me acostumar com os fundamentos da linguagem e a sintaxe do Elixir que eu me dei conta do quão <em><!--[-->foda<!--]--></em> pipes podem ser!<!--]--></p><p><!--[-->E eu, como um bom artista, não pude me esquecer dos ensinamentos do Austin Kleon. Roubei a ideia do pipe do Elixir e transformei ela em algo novo:<!--]--></p><blockquote><!--[--><p><!--[-->E se tivesse um pipe que fosse a composição de diversas operações aplicadas sequencialmente em uma *única* passagem pelo array?<!--]--></p><!--]--></blockquote><p><!--[-->Estava feito o estrago. Alguns dias depois saí da minha caverna com alguns neurônios a menos e algumas linhas a mais.<!--]--></p><h3 id="primeiros-passos-com-engenharia-hidráulica"><!--[-->Primeiros passos com Engenharia Hidráulica<!--]--></h3><section class="footnotes" data-footnotes><h2 id="footnote-label" class="sr-only"><!--[-->Footnotes<!--]--></h2><ol><!--[--><li id="user-content-fn-typescript"><!--[-->TypeScript é fenomenal, mas isso é tópico pra outro dia <a href="#user-content-fnref-typescript" rel="noopener noreferrer" target="_blank" aria-label="Back to reference 1" class="data-footnote-backref" data-footnote-backref data-v-8e2d3e8b><!--[-->↩<!--]--></a><!--]--></li><li id="user-content-fn-2"><!--[--><a href="https://xkcd.com/285/" rel="nofollow" target="_blank" data-v-8e2d3e8b><!--[-->Citação necessária<!--]--></a> <a href="#user-content-fnref-2" rel="noopener noreferrer" target="_blank" aria-label="Back to reference 2" class="data-footnote-backref" data-footnote-backref data-v-8e2d3e8b><!--[-->↩<!--]--></a><!--]--></li><li id="user-content-fn-3"><!--[-->Linguagens novas e TDAH não se misturam, ok? <a href="#user-content-fnref-3" rel="noopener noreferrer" target="_blank" aria-label="Back to reference 3" class="data-footnote-backref" data-footnote-backref data-v-8e2d3e8b><!--[-->↩<!--]--></a><!--]--></li><!--]--></ol></section><style>html pre.shiki code .sG605, html code.shiki .sG605{--shiki-default:#FE8019}html pre.shiki code .sMWUE, html code.shiki .sMWUE{--shiki-default:#83A598}html pre.shiki code .sM2RB, html code.shiki .sM2RB{--shiki-default:#8EC07C}html pre.shiki code .sM0OT, html code.shiki .sM0OT{--shiki-default:#EBDBB2}html pre.shiki code .ssIPD, html code.shiki .ssIPD{--shiki-default:#D3869B}html pre.shiki code .svnLg, html code.shiki .svnLg{--shiki-default:#A89984}html pre.shiki code .s59W0, html code.shiki .s59W0{--shiki-default:#FABD2F}html pre.shiki code .s-UKz, html code.shiki .s-UKz{--shiki-default:#928374;--shiki-default-font-style:italic}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></article></main></div></div><div id="teleports"></div><script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/blog/performance-arrays/_payload.json?f8327c24-0f4e-45b2-b0ba-77ba32894543">[{"state":1,"once":3,"_errors":4,"serverRendered":7,"path":8,"prerenderedAt":9},["Reactive",2],{},["Set"],["ShallowReactive",5],{"post":6},null,true,"/blog/performance-arrays",1752116405167]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{content:{wsUrl:""},mdc:{components:{prose:true,map:{}},headings:{anchorLinks:false}}},app:{baseURL:"/",buildId:"f8327c24-0f4e-45b2-b0ba-77ba32894543",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>